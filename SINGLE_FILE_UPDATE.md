# 单文件存储更新说明

## 更新内容

本次更新将数据存储方式从多文件备份机制改为单文件存储机制，简化了数据管理。

## 主要变更

### 1. 数据存储方式
- **之前**: 自动创建多个备份文件（`backup_dish_data.json`, `manual_backup_*.json`）
- **现在**: 只使用单个数据文件（`dish_data.json`）进行存储和更新

### 2. 界面变更
- **移除功能**: "创建备份"按钮
- **移除功能**: "导入数据"按钮
- **保留功能**: "导出Excel"按钮
- **保留功能**: "查看数据信息"按钮

### 3. 代码变更
- 移除了 `DataManager` 类中的备份相关方法
- 移除了主界面中的备份和导入功能
- 简化了数据保存逻辑，只更新单个文件

## 优势

1. **简化管理**: 不再产生多个备份文件，避免文件混乱
2. **节省空间**: 减少磁盘空间占用
3. **操作简单**: 用户只需关注一个数据文件
4. **性能提升**: 减少文件操作，提高保存速度

## 数据安全

虽然移除了自动备份功能，但仍保持数据安全：

1. **原子操作**: 使用临时文件确保写入安全
2. **错误处理**: 完善的异常处理机制
3. **手动备份**: 用户可手动复制 `dish_data.json` 文件
4. **Excel导出**: 可导出数据作为备份

## 兼容性

- 现有的 `dish_data.json` 文件完全兼容
- 程序会自动处理数据格式升级
- EXE打包功能不受影响

## 测试验证

已通过 `test_single_file.py` 脚本验证：
- ✅ 单文件存储功能
- ✅ 多次保存操作
- ✅ 数据完整性
- ✅ 文件数量控制

## 使用建议

1. 如需备份，请手动复制 `dish_data.json` 文件
2. 定期使用"导出Excel"功能保存数据副本
3. 重要操作前可先复制数据文件

---

更新日期: 2024-12-30
版本: v2.0 (单文件存储版本)